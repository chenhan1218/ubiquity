#!/bin/sh
#make -C d-i update
#make -C d-i build
#make -C d-i install
(cat d-i/templates; echo; po2debconf debian/ubiquity.templates; echo; po2debconf debian/ubiquity.templates-imported --podir=debian/imported-po) > tests/debconfdb
#export DEBCONF_DB_REPLACE="File{tests/debconfdb.dat}"
cat > tests/debconf.conf << EOF
Config: configdb
Templates: templatedb

Name: configdb
Driver: File
Mode: 644
Filename: tests/config.dat

Name: templatedb
Driver: File
Mode: 644
Filename: tests/templates.dat
EOF
export DEBCONF_SYSTEMRC=tests/debconf.conf
debconf-loadtemplate ubiquity tests/debconfdb
# For log-output
export PATH="d-i/source/debian-installer-utils:$PATH"
UBIQUITY_PLUGIN_PATH=ubiquity/plugins PIXMAPS=desktop UBIQUITY_GLADE=gui/gtk ./tests/run-gtk
